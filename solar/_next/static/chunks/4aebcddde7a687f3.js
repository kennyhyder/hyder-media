(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,88249,(e,t,a)=>{t.exports=e.r(50934)},69824,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let s=e.r(30438);function l({reason:e,children:t}){if("u"<typeof window)throw Object.defineProperty(new s.BailoutToCSRError(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return t}},30434,(e,t,a)=>{"use strict";function s(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"encodeURIPath",{enumerable:!0,get:function(){return s}})},33737,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"PreloadChunks",{enumerable:!0,get:function(){return o}});let s=e.r(10267),l=e.r(92395),r=e.r(34767),n=e.r(30434),i=e.r(45679);function o({moduleIds:e}){if("u">typeof window)return null;let t=r.workAsyncStorage.getStore();if(void 0===t)return null;let a=[];if(t.reactLoadableManifest&&e){let s=t.reactLoadableManifest;for(let t of e){if(!s[t])continue;let e=s[t].files;a.push(...e)}}if(0===a.length)return null;let o=(0,i.getDeploymentIdQueryOrEmptyString)();return(0,s.jsx)(s.Fragment,{children:a.map(e=>{let a=`${t.assetPrefix}/_next/${(0,n.encodeURIPath)(e)}${o}`;return e.endsWith(".css")?(0,s.jsx)("link",{precedence:"dynamic",href:a,rel:"stylesheet",as:"style",nonce:t.nonce},e):((0,l.preload)(a,{as:"script",fetchPriority:"low",nonce:t.nonce}),null)})})}},72957,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"default",{enumerable:!0,get:function(){return d}});let s=e.r(10267),l=e.r(56068),r=e.r(69824),n=e.r(33737);function i(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},d=function(e){let t={...o,...e},a=(0,l.lazy)(()=>t.loader().then(i)),d=t.loading;function c(e){let i=d?(0,s.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,o=!t.ssr||!!t.loading,c=o?l.Suspense:l.Fragment,u=t.ssr?(0,s.jsxs)(s.Fragment,{children:["u"<typeof window?(0,s.jsx)(n.PreloadChunks,{moduleIds:t.modules}):null,(0,s.jsx)(a,{...e})]}):(0,s.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(a,{...e})});return(0,s.jsx)(c,{...o?{fallback:i}:{},children:u})}return c.displayName="LoadableComponent",c}},69782,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"default",{enumerable:!0,get:function(){return l}});let s=e.r(13288)._(e.r(72957));function l(e,t){let a={};"function"==typeof e&&(a.loader=e);let l={...a,...t};return(0,s.default)({...l,modules:l.loadableGenerated?.modules})}("function"==typeof a.default||"object"==typeof a.default&&null!==a.default)&&void 0===a.default.__esModule&&(Object.defineProperty(a.default,"__esModule",{value:!0}),Object.assign(a.default,a),t.exports=a.default)},93732,e=>{"use strict";var t=e.i(10267),a=e.i(56068),s=e.i(88249);let l=(0,e.i(69782).default)(()=>e.A(73117),{loadableGenerated:{modules:[73383]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"h-[400px] bg-gray-100 rounded-lg flex items-center justify-center text-gray-400",children:"Loading map..."})}),r="localhost"===window.location.hostname?"http://localhost:3000/api/solar":"/api/solar",n=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];function i({label:e,sortKey:a,currentSort:s,currentDir:l,onSort:r,align:n}){let i=s===a;return(0,t.jsxs)("th",{className:`${"right"===n?"text-right":"text-left"} px-4 py-3 font-medium text-gray-500 cursor-pointer hover:text-gray-900 select-none`,onClick:()=>r(a),children:[e," ",(0,t.jsx)("span",{className:i?"text-blue-600":"text-gray-300",children:i?"asc"===l?"▲":"▼":"▴"})]})}function o(){let e=(0,s.useSearchParams)(),[o,d]=(0,a.useState)([]),[c,u]=(0,a.useState)(null),[m,x]=(0,a.useState)(!1),[p,h]=(0,a.useState)(!1),[g,y]=(0,a.useState)(!1),[b,j]=(0,a.useState)(!1),[f,_]=(0,a.useState)({state:e.get("state")||"",min_size:e.get("min_size")||"",max_size:e.get("max_size")||"",start_date:e.get("start_date")||"",end_date:e.get("end_date")||"",site_type:e.get("site_type")||"",site_status:e.get("site_status")||"active",installer:e.get("installer")||"",owner:e.get("owner")||"",q:e.get("q")||"",near_lat:e.get("near_lat")||"",near_lng:e.get("near_lng")||"",radius_miles:e.get("radius_miles")||""}),[v,N]=(0,a.useState)(1),[w,S]=(0,a.useState)("capacity_mw"),[k,C]=(0,a.useState)("desc"),P={site_name:"site_name",state:"state",site_type:"site_type",capacity_mw:"capacity_mw",install_date:"install_date",site_status:"site_status",owner_name:"site_name"},O=(0,a.useCallback)(async e=>{x(!0);let t=new URLSearchParams({page:String(e),limit:"25"});Object.entries(f).forEach(([e,a])=>{a&&t.set(e,a)});let a=P[w]||"capacity_mw";t.set("sort",a),t.set("order",k);try{let e=await fetch(`${r}/installations?${t}`),a=await e.json();d(a.data||[]),u(a.pagination)}catch(e){console.error(e)}finally{x(!1)}},[f,w,k]);(0,a.useEffect)(()=>{O(v)},[v,O]);let M=e=>{w===e?C(e=>"asc"===e?"desc":"asc"):(S(e),C("capacity_mw"===e?"desc":"asc")),N(1)},L=async()=>{y(!0);let e=new URLSearchParams;Object.entries(f).forEach(([t,a])=>{a&&e.set(t,a)}),e.set("limit","10000");try{let t=await fetch(`${r}/export?${e}`),a=await t.blob(),s=URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download=`solar_installations_${new Date().toISOString().slice(0,10)}.csv`,l.click(),URL.revokeObjectURL(s)}catch(e){console.error("Export failed:",e)}finally{y(!1)}},R=(0,a.useMemo)(()=>[...o].sort((e,t)=>{let a=null,s=null;switch(w){case"site_name":a=e.site_name||e.county||"",s=t.site_name||t.county||"";break;case"state":a=e.state||"",s=t.state||"";break;case"site_type":a=e.site_type,s=t.site_type;break;case"capacity_mw":a=Number(e.capacity_mw)||0,s=Number(t.capacity_mw)||0;break;case"install_date":a=e.install_date||"",s=t.install_date||"";break;case"site_status":a=e.site_status||"",s=t.site_status||"";break;case"owner_name":a=e.owner_name||"",s=t.owner_name||""}null===a&&(a=""),null===s&&(s="");let l="number"==typeof a&&"number"==typeof s?a-s:String(a).localeCompare(String(s));return"asc"===k?l:-l}),[o,w,k]);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Search Installations"}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),N(1),f.near_lat&&h(!0),O(1)},className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Text Search"}),(0,t.jsx)("input",{type:"text",value:f.q,onChange:e=>_({...f,q:e.target.value}),placeholder:"Site name, county...",className:"w-full border rounded-md px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),(0,t.jsxs)("select",{value:f.state,onChange:e=>_({...f,state:e.target.value}),className:"w-full border rounded-md px-3 py-2 text-sm",children:[(0,t.jsx)("option",{value:"",children:"All States"}),n.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Site Type"}),(0,t.jsxs)("select",{value:f.site_type,onChange:e=>_({...f,site_type:e.target.value}),className:"w-full border rounded-md px-3 py-2 text-sm",children:[(0,t.jsx)("option",{value:"",children:"All Types"}),(0,t.jsx)("option",{value:"utility",children:"Utility"}),(0,t.jsx)("option",{value:"commercial",children:"Commercial"}),(0,t.jsx)("option",{value:"community",children:"Community"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,t.jsxs)("select",{value:f.site_status,onChange:e=>_({...f,site_status:e.target.value}),className:"w-full border rounded-md px-3 py-2 text-sm",children:[(0,t.jsx)("option",{value:"",children:"All Statuses"}),(0,t.jsx)("option",{value:"active",children:"Active"}),(0,t.jsx)("option",{value:"proposed",children:"Proposed / Planned"}),(0,t.jsx)("option",{value:"under_construction",children:"Under Construction"}),(0,t.jsx)("option",{value:"retired",children:"Retired"}),(0,t.jsx)("option",{value:"decommissioned",children:"Decommissioned"}),(0,t.jsx)("option",{value:"canceled",children:"Canceled"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Size (kW)"}),(0,t.jsx)("input",{type:"number",value:f.min_size,onChange:e=>_({...f,min_size:e.target.value}),placeholder:"e.g. 1000",className:"w-full border rounded-md px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Size (kW)"}),(0,t.jsx)("input",{type:"number",value:f.max_size,onChange:e=>_({...f,max_size:e.target.value}),placeholder:"e.g. 50000",className:"w-full border rounded-md px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Installer"}),(0,t.jsx)("input",{type:"text",value:f.installer,onChange:e=>_({...f,installer:e.target.value}),placeholder:"Installer name...",className:"w-full border rounded-md px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner"}),(0,t.jsx)("input",{type:"text",value:f.owner,onChange:e=>_({...f,owner:e.target.value}),placeholder:"Owner name...",className:"w-full border rounded-md px-3 py-2 text-sm"})]}),(0,t.jsx)("div",{className:"flex items-end gap-2",children:(0,t.jsx)("button",{type:"submit",className:"flex-1 bg-blue-600 text-white rounded-md px-4 py-2 text-sm font-medium hover:bg-blue-700",children:"Search"})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),(0,t.jsx)("input",{type:"date",value:f.start_date,onChange:e=>_({...f,start_date:e.target.value}),className:"w-full border rounded-md px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),(0,t.jsx)("input",{type:"date",value:f.end_date,onChange:e=>_({...f,end_date:e.target.value}),className:"w-full border rounded-md px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Near Me"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{type:"button",disabled:b,onClick:()=>{navigator.geolocation&&(j(!0),navigator.geolocation.getCurrentPosition(e=>{_(t=>({...t,near_lat:e.coords.latitude.toFixed(4),near_lng:e.coords.longitude.toFixed(4),radius_miles:t.radius_miles||"50"})),j(!1)},()=>j(!1),{timeout:1e4}))},className:"flex-1 bg-gray-100 border rounded-md px-3 py-2 text-sm hover:bg-gray-200 disabled:opacity-50",children:b?"Locating...":f.near_lat?`${f.near_lat}, ${f.near_lng}`:"Use Location"}),f.near_lat&&(0,t.jsx)("button",{type:"button",onClick:()=>_(e=>({...e,near_lat:"",near_lng:"",radius_miles:""})),className:"px-2 text-gray-400 hover:text-gray-600",children:"x"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Radius (miles)"}),(0,t.jsxs)("select",{value:f.radius_miles,onChange:e=>_({...f,radius_miles:e.target.value}),className:"w-full border rounded-md px-3 py-2 text-sm",disabled:!f.near_lat,children:[(0,t.jsx)("option",{value:"",children:"-"}),(0,t.jsx)("option",{value:"10",children:"10 miles"}),(0,t.jsx)("option",{value:"25",children:"25 miles"}),(0,t.jsx)("option",{value:"50",children:"50 miles"}),(0,t.jsx)("option",{value:"100",children:"100 miles"}),(0,t.jsx)("option",{value:"200",children:"200 miles"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex gap-3",children:(0,t.jsx)("button",{onClick:()=>h(!p),className:`px-4 py-2 rounded-md text-sm font-medium border transition ${p?"bg-blue-50 border-blue-300 text-blue-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:p?"Hide Map":"Show Map"})}),(0,t.jsx)("button",{onClick:L,disabled:g||!c?.total,className:"px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:g?"Exporting...":`Export CSV${c?.total?` (${Math.min(c.total,1e4).toLocaleString()})`:""}`})]}),p&&o.length>0&&(0,t.jsx)(l,{installations:o}),m?(0,t.jsx)("div",{className:"text-center py-12 text-gray-500",children:"Searching..."}):(0,t.jsxs)(t.Fragment,{children:[c&&(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:[c.total.toLocaleString()," results found"]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)(i,{label:"Site",sortKey:"site_name",currentSort:w,currentDir:k,onSort:M}),(0,t.jsx)(i,{label:"State",sortKey:"state",currentSort:w,currentDir:k,onSort:M}),(0,t.jsx)(i,{label:"Type",sortKey:"site_type",currentSort:w,currentDir:k,onSort:M}),(0,t.jsx)(i,{label:"Owner",sortKey:"owner_name",currentSort:w,currentDir:k,onSort:M}),(0,t.jsx)(i,{label:"Capacity",sortKey:"capacity_mw",currentSort:w,currentDir:k,onSort:M,align:"right"}),(0,t.jsx)(i,{label:"Year",sortKey:"install_date",currentSort:w,currentDir:k,onSort:M}),(0,t.jsx)(i,{label:"Status",sortKey:"site_status",currentSort:w,currentDir:k,onSort:M}),f.near_lat&&(0,t.jsx)("th",{className:"text-right px-4 py-3 font-medium text-gray-500",children:"Distance"})]})}),(0,t.jsxs)("tbody",{children:[R.map(e=>(0,t.jsxs)("tr",{className:"border-t hover:bg-gray-50",children:[(0,t.jsxs)("td",{className:"px-4 py-3",children:[(0,t.jsx)("a",{href:`/solar/site/?id=${e.id}`,className:"text-blue-600 hover:underline font-medium",children:e.site_name||e.county||"Unknown"}),e.county&&e.site_name&&(0,t.jsx)("div",{className:"text-xs text-gray-400",children:e.county})]}),(0,t.jsx)("td",{className:"px-4 py-3",children:e.state}),(0,t.jsx)("td",{className:"px-4 py-3 capitalize",children:e.site_type}),(0,t.jsx)("td",{className:"px-4 py-3 text-gray-500",children:e.owner_name||(0,t.jsx)("span",{className:"text-gray-300",children:"-"})}),(0,t.jsx)("td",{className:"px-4 py-3 text-right font-mono",children:e.capacity_mw?`${Number(e.capacity_mw).toFixed(1)} MW`:e.capacity_dc_kw?`${Number(e.capacity_dc_kw).toLocaleString()} kW`:"-"}),(0,t.jsx)("td",{className:"px-4 py-3 text-gray-500",children:e.install_date?.substring(0,4)||"-"}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("span",{className:`inline-block px-2 py-0.5 rounded text-xs font-medium ${"active"===e.site_status?"bg-green-100 text-green-700":"proposed"===e.site_status?"bg-yellow-100 text-yellow-700":"under_construction"===e.site_status?"bg-blue-100 text-blue-700":"retired"===e.site_status||"decommissioned"===e.site_status?"bg-red-100 text-red-700":(e.site_status,"bg-gray-100 text-gray-500")}`,children:"under_construction"===e.site_status?"building":e.site_status||"-"})}),f.near_lat&&(0,t.jsx)("td",{className:"px-4 py-3 text-right text-gray-500 font-mono",children:null!=e.distance_miles?`${Number(e.distance_miles).toFixed(1)} mi`:"-"})]},e.id)),0===o.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-400",children:"No results found"})})]})]})}),c&&c.totalPages>1&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("button",{onClick:()=>N(e=>Math.max(1,e-1)),disabled:1===v,className:"px-4 py-2 border rounded-md text-sm disabled:opacity-50",children:"Previous"}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["Page ",v," of ",c.totalPages.toLocaleString()]}),(0,t.jsx)("button",{onClick:()=>N(e=>Math.min(c.totalPages,e+1)),disabled:v>=c.totalPages,className:"px-4 py-2 border rounded-md text-sm disabled:opacity-50",children:"Next"})]})]})]})}function d(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{className:"text-gray-500",children:"Loading search..."}),children:(0,t.jsx)(o,{})})}e.s(["default",()=>d])},73117,e=>{e.v(t=>Promise.all(["static/chunks/f3b2bc2904699f64.js"].map(t=>e.l(t))).then(()=>t(73383)))}]);